<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="styles.css">
    <title>Password Page</title>
    <style>
#passwordInput {
  width: 200px; /* Set the width of the input field */
  height: 30px; /* Set the height of the input field */
  padding: 5px; /* Add some padding inside the input field */
  border: 1px solid #ccc; /* Add a border around the input field */
  border-radius: 5px; /* Add rounded corners to the input field */
  font-size: 16px; /* Set the font size of the text inside the input field */
  outline: none; /* Remove the default outline */
}

#passwordInput:focus {
  border-color: #007bff; /* Change the border color when the input field is focused */
  box-shadow: 0 0 5px rgba(0, 123, 255, 0.5); /* Add a shadow when the input field is focused */
}

#passwordForm {
  position: fixed; /* Position the element relative to the viewport */
  top: 50%; /* Move the element down by 50% of the viewport height */
  left: 50%; /* Move the element right by 50% of the viewport width */
  transform: translate(-50%, -50%); /* Adjust position to center based on element's dimensions */
  /* Additional styling for password form as needed */
}

.button-6 {
  align-items: center;
  background-color: #FFFFFF;
  border: 1px solid rgba(0, 0, 0, 0.1);
  border-radius: .25rem;
  box-shadow: rgba(0, 0, 0, 0.02) 0 1px 3px 0;
  box-sizing: border-box;
  color: rgba(0, 0, 0, 0.85);
  cursor: pointer;
  display: inline-flex;
  font-family: system-ui,-apple-system,system-ui,"Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size: 16px;
  font-weight: 600;
  justify-content: center;
  line-height: 1.25;
  margin: 0;
  min-height: 3rem;
  padding: calc(.875rem - 1px) calc(1.5rem - 1px);
  position: relative;
  text-decoration: none;
  transition: all 250ms;
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  vertical-align: baseline;
  width: auto;
}

.button-6:hover,
.button-6:focus {
  border-color: rgba(0, 0, 0, 0.15);
  box-shadow: rgba(0, 0, 0, 0.1) 0 4px 12px;
  color: rgba(0, 0, 0, 0.65);
}

.button-6:hover {
  transform: translateY(-1px);
}

.button-6:active {
  background-color: #F0F0F1;
  border-color: rgba(0, 0, 0, 0.15);
  box-shadow: rgba(0, 0, 0, 0.06) 0 2px 4px;
  color: rgba(0, 0, 0, 0.65);
  transform: translateY(0);
}
    </style>

</head>
<body>
    <form id="passwordForm">
        <input type="password" id="passwordInput" placeholder="Enter password" required>
        <button type="submit" class="button-6">Submit</button>
    </form>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script>
        document.getElementById('passwordForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const enteredPassword = document.getElementById('passwordInput').value;
            const enteredPasswordHash = CryptoJS.SHA256(enteredPassword).toString();

            // Perform AJAX request to fetch passwords from ac-pass.txt
            const xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    if (xhr.status === 200) {
                        const passwords = xhr.responseText.split('\n');
                        let passwordFound = false;
                        passwords.forEach(passwordLine => {
                            const [hashedPassword, expirationDate] = passwordLine.split(' ');
                            if (hashedPassword === enteredPasswordHash) {
                                const today = new Date();
                                const expiration = new Date(expirationDate);
                                if (expiration > today) {
                                    passwordFound = true;
                                    window.location.href = 'main.html'; // Redirect to success PHP page
                                } else {
                                    alert('Password expired.');
                                }
                            }
                        });
                        if (!passwordFound) {
                            alert('Incorrect password.');
                        }
                    } else {
                        console.error('Failed to fetch passwords:', xhr.status);
                    }
                }
            };
            xhr.open('GET', 'ac-pass.txt', true);
            xhr.send();
        });
    </script>
</body>
</html>
